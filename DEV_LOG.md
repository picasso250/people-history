# 《众语史书》开发日志

本文档记录了《众语史书》(People's History) 项目在开发过程中的关键决策、技术里程碑和思考过程。

---

### **2025/10/17: 里程碑 - 首次链上数据读写闭环测试成功**

**状态**: `已完成` ✅

**核心目标**: 验证项目最核心的技术链路——能否将一条数据通过智能合约写入测试网，并用脚本成功地从链上读取出来。

#### **行动与事件回顾**:

1.  **初步脚本实现**:
    *   完成了第一版 `read_history.js` 脚本，其设计目标是从 Sepolia 测试网的创世区块开始扫描，获取所有 `Record` 事件。

2.  **遭遇并解决 RPC 连接问题**:
    *   **问题**: 在执行脚本时，遭遇 `Error: server response 522`。
    *   **分析**: 该错误指向 `rpc.sepolia.org` 这个公共 RPC 节点的连接超时或不稳定。这是公共节点的常见问题。
    *   **决策**: 为了提高脚本的健壮性，果断放弃不稳定的公共节点，转而采用更专业的 Alchemy RPC 服务。

3.  **遭遇并适应 API 限制**:
    *   **问题**: 更换为 Alchemy 节点后，脚本执行失败，返回错误 `Under the Free tier plan, you can make eth_getLogs requests with up to a 10 block range.`
    *   **分析**: Alchemy 的免费套餐对单次 `eth_getLogs` 请求的区块扫描范围有10个区块的限制。我们一次性扫描几千个区块的请求因此被拒绝。
    *   **决策与反思**:
        *   我们一度试图构建一个复杂的分块查询循环来绕过此限制。
        *   但我们很快意识到，这违反了 **“实用主义 (Pragmatism)”** 原则。在当前 **“快速验证”** 的阶段，引入不必要的代码复杂度是错误的。
        *   最终，我们采纳了最简洁、最高效的方案：**将脚本的查询范围直接修改为最新的10个区块**。

4.  **最终成功**:
    *   调整后的脚本成功执行。
    *   脚本准确地连接到 Sepolia 测试网，扫描了最新的10个区块，并成功打印出了我们之前写入的测试内容 `("hel ww12121")`。

#### **结论**:

本次测试的成功，标志着《众语史书》项目在技术上是完全可行的。我们已经打通了从“铭刻”到“读取”的核心环节，为下一阶段的开发工作（如起草正式的技术规范、设计前端界面）奠定了坚实的基础。